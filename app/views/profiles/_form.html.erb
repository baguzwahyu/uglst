<div class="row col-sm-6">
  <%= form_for(@user, as: :user, url: profile_path(@user), html: { role: 'form', class: '' }) do |f| %>
    <% if @user.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(@user.errors.count, "error") %> prohibited this User-Group from being saved:</h2>
        <ul>
          <% @user.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <fieldset>
      <legend>Account Info</legend>
      <div class="form-group col-sm-12">
        <%= f.label :username, class: 'control-label' %>
        <%= f.text_field :username, class: 'form-control', disabled: true, enabled: false %>
        <p class="help-block">Send an email to <a href="mailto:support+changename@ugl.st">support</a> to change your username.</p>
      </div>
      <div class="form-group col-sm-2" id="gravatar_preview">
        <%= gravatar_image_tag(@user.email, alt: @user.full_name, alt: @user.full_name, id: 'gravatar', class: 'img-rounded') %>
      </div>
      <div class="form-group col-sm-10">
        <%= f.label :email, class: 'control-label' %>
        <%= f.text_field :email, class: 'form-control' %>
      </div>
      <div class="form-group col-sm-12">
        <%= f.label :interests, class: 'control-label' %>
        <%= f.text_field :interests, class: 'form-control', value: safe_join(@user.interests, ', ') %>
        <p class="help-block">Comma separated list of interests.</a>
      </div>
    </fieldset>

    <fieldset>
      <legend>Public Info</legend>
      <div class="form-group">
        <%= f.label :first_name, class: 'control-label' %>
        <%= f.text_field :first_name, class: 'form-control' %>
      </div>
      <div class="form-group">
        <%= f.label :last_name, class: 'control-label' %>
        <%= f.text_field :last_name, class: 'form-control' %>
      </div>
      <div class="form-group">
        <%= f.label :bio, class: 'control-label' %>
        <%= f.text_area :bio, rows: 3, class: 'form-control' %>
      </div>
    </fieldset>

    <fieldset>
      <legend>Online Info</legend>
      <div class="form-group">
        <%= f.label :homepage, class: 'control-label' %>
        <%= f.text_field :homepage, class: 'form-control' %>
      </div>
      <div class="form-group">
        <%= f.label :twitter, class: 'control-label' %>
        <%= f.text_field :twitter, placeholder: 'https://twitter.com/ugtastic', class: 'form-control'  %>
      </div>
    </fieldset>

    <fieldset class="row">
      <legend>Geographic Info</legend>
      <div class="form-group">
        <%= f.label :address, class: 'control-label' %>
        <%= f.text_field :address, placeholder: '', class: 'form-control'  %>
      </div>
      <!-- <div style="padding: 0; margin: 0; width: 570px">
        <div id="map" style='width: 570px; height: 238px;'></div>
      </div> -->
    </fieldset>

    <fieldset>
      <legend>Sensitive Info</legend>
      <div class='bs-callout bs-callout-warning'>
        <strong>Why are we asking for this information?</strong>
        <p>In a nutshell this data can help to build a better understanding of people as they are represented in the technical community.</p>
        <p>You are free to fill in as little or as much as you are comfortable sharing. The presence of this information will have no negative </p>
        <p>This information is stored in encrypted fields and is marked to be excluded from logging and New Relic. We strive to protect your sensitive data and appreciate your trust.</p>
        <p>If you have any questions or concerns about how we collect and store private data feel free to <a href="mailto:mike+privacy@ugl.st">contact us</a>.</a>
      </div>
      <div class="form-group">
        <%= f.label :birthday, class: 'control-label' %>
        <%= f.text_field :birthday, class: 'datepicker form-control', 'data-behaviour' => 'datepicker', placeholder: 'MM/DD/YYYY' %>
      </div>
      <div class="form-group">
        <%= f.label :gender, class: 'control-label' %>
        <%= f.text_field :gender, class: 'form-control' %>
        <div class="help-block">Please provide the gender you identify as.</div>
      </div>
      <div class="form-group">
        <%= f.label :parental_status, class: 'control-label' %>
        <%= f.text_field :parental_status, class: 'form-control' %>
      </div>
      <div class="form-group">
        <%= f.label :ethnicity, class: 'control-label' %>
        <%= f.text_field :ethnicity, class: 'form-control' %>
      </div>
      <div class="form-group">
        <%= f.label :race, class: 'control-label' %>
        <%= f.text_field :race, class: 'form-control' %>
      </div>
      <div class="form-group">
        <%= f.label :relationship_status, class: 'control-label' %>
        <%= f.text_field :relationship_status, class: 'form-control' %>
      </div>
      <div class="form-group">
        <%= f.label :sexual_orientation, class: 'control-label' %>
        <%= f.text_field :sexual_orientation, class: 'form-control' %>
      </div>
      <div class="form-group">
        <%= f.label :religious_affiliation, class: 'control-label' %>
        <%= f.text_field :religious_affiliation, class: 'form-control' %>
      </div>
    </fieldset>


    <% if current_user && current_user.admin? %>
      <fieldset>
        <legend>Admin Fields</legend>

        <div class="form-group">
          <%= f.label :slug, class: 'control-label' %>
          <%= f.text_field :slug, disabled: true, class: 'form-control' %>
        </div>

        <div class="form-group">
          <%= f.label :latitude, class: 'control-label'  %>
          <%= f.text_field :latitude, class: 'form-control' %>
        </div>

        <div class="form-group">
          <%= f.label :longitude, class: 'control-label'  %>
          <%= f.text_field :longitude, class: 'form-control' %>
        </div>

        <div class="form-group">
          <%= f.label :slug, class: 'control-label'  %>
          <%= f.text_field :slug, rows: 3, class: 'form-control' %>
        </div>
      </fieldset>
    <% end %>

    <div class="actions">
      <%= f.submit 'Save Profile', class: 'btn btn-primary' %>
    </div>
  <% end %>
</div>

<%= content_for :javascript do %>
  <script type="text/javascript">
    $(document).ready(function () {
      $('.datepicker').datepicker();

      // handler = Gmaps.build('Google');
      // handler.buildMap({
      //   internal: { id: 'map' }
      // }, function () {
      //   markers = handler.addMarkers(<%= raw @markers.to_json %>);
      //   handler.bounds.extendWith(markers);
      //   handler.fitMapToBounds();
      //   handler.getMap().setZoom(10);
      // });

      $('#user_email').blur(function () {
        // https://secure.gravatar.com/avatar/6d920a946a2ee97a73ad43030381231c?default=identicon&amp;secure=true
        var gravatar_url = 'https://secure.gravatar.com/avatar/' + md5($('#user_email').val()) + '?default=identicon&amp;secure=true';
        console.log(gravatar_url);
        $('#gravatar').attr('src', gravatar_url);
      });
    });
  </script>
<% end %>

